INSERT INTO analysis.silver_accident
SELECT
    TRY_CAST(STATE AS INTEGER) AS state,
    STATENAME AS state_name,
    TRY_CAST(ST_CASE AS INTEGER) AS st_case,
    TRY_CAST(PEDS AS INTEGER) AS peds,
    TRY_CAST(PERNOTMVIT AS INTEGER) AS per_not_mvit,
    TRY_CAST(VE_TOTAL AS INTEGER) AS ve_total,
    TRY_CAST(VE_FORMS AS INTEGER) AS ve_forms,
    TRY_CAST(PVH_INVL AS INTEGER) AS pvh_invl,
    TRY_CAST(PERSONS AS INTEGER) AS persons,
    TRY_CAST(PERMVIT AS INTEGER) AS per_mvit,
    TRY_CAST(COUNTY AS INTEGER) AS county,
    COUNTYNAME AS county_name,
    TRY_CAST(CITY AS INTEGER) AS city,
    CITYNAME AS city_name,
    TRY_CAST(MONTH AS INTEGER) AS month,
    MONTHNAME AS month_name,
    TRY_CAST(DAY AS INTEGER) AS day,
    DAYNAME AS day_name,
    TRY_CAST(DAY_WEEK AS INTEGER) AS day_week,
    DAY_WEEKNAME AS day_week_name,
    TRY_CAST(YEAR AS INTEGER) AS year,
    TRY_CAST(HOUR AS INTEGER) AS hour,
    HOURNAME AS hour_name,
    TRY_CAST(MINUTE AS INTEGER) AS minute,
    MINUTENAME AS minute_name,
    TWAY_ID,
    TWAY_ID2,
    ROUTE,
    ROUTENAME,
    TRY_CAST(RUR_URB AS INTEGER) AS rur_urb,
    RUR_URBNAME AS rur_urb_name,
    TRY_CAST(FUNC_SYS AS INTEGER) AS func_sys,
    FUNC_SYSNAME AS func_sys_name,
    TRY_CAST(RD_OWNER AS INTEGER) AS rd_owner,
    RD_OWNERNAME AS rd_owner_name,
    TRY_CAST(NHS AS INTEGER) AS nhs,
    NHSNAME AS nhs_name,
    TRY_CAST(SP_JUR AS INTEGER) AS sp_jur,
    SP_JURNAME AS sp_jur_name,
    TRY_CAST(MILEPT AS FLOAT) AS milept,
    MILEPTNAME AS milept_name,
    TRY_CAST(LATITUDE AS FLOAT) AS latitude,
    LATITUDENAME AS latitude_name,
    TRY_CAST(LONGITUD AS FLOAT) AS longitude,
    LONGITUDNAME AS longitude_name,
    TRY_CAST(HARM_EV AS INTEGER) AS harm_ev,
    HARM_EVNAME AS harm_ev_name,
    TRY_CAST(MAN_COLL AS INTEGER) AS man_coll,
    MAN_COLLNAME AS man_coll_name,
    TRY_CAST(RELJCT1 AS INTEGER) AS reljct1,
    RELJCT1NAME AS reljct1_name,
    TRY_CAST(RELJCT2 AS INTEGER) AS reljct2,
    RELJCT2NAME AS reljct2_name,
    TRY_CAST(TYP_INT AS INTEGER) AS typ_int,
    TYP_INTNAME AS typ_int_name,
    TRY_CAST(REL_ROAD AS INTEGER) AS rel_road,
    REL_ROADNAME AS rel_road_name,
    TRY_CAST(WRK_ZONE AS INTEGER) AS wrk_zone,
    WRK_ZONENAME AS wrk_zone_name,
    TRY_CAST(LGT_COND AS INTEGER) AS lgt_cond,
    LGT_CONDNAME AS lgt_cond_name,
    TRY_CAST(WEATHER AS INTEGER) AS weather,
    WEATHERNAME AS weather_name,
    TRY_CAST(SCH_BUS AS INTEGER) AS sch_bus,
    SCH_BUSNAME AS sch_bus_name,
    TRY_CAST(RAIL AS INTEGER) AS rail,
    RAILNAME AS rail_name,
    TRY_CAST(NOT_HOUR AS INTEGER) AS not_hour,
    NOT_HOURNAME AS not_hour_name,
    TRY_CAST(NOT_MIN AS INTEGER) AS not_min,
    NOT_MINNAME AS not_min_name,
    TRY_CAST(ARR_HOUR AS INTEGER) AS arr_hour,
    ARR_HOURNAME AS arr_hour_name,
    TRY_CAST(ARR_MIN AS INTEGER) AS arr_min,
    ARR_MINNAME AS arr_min_name,
    TRY_CAST(HOSP_HR AS INTEGER) AS hosp_hr,
    HOSP_HRNAME AS hosp_hr_name,
    TRY_CAST(HOSP_MN AS INTEGER) AS hosp_mn,
    HOSP_MNNAME AS hosp_mn_name,
    TRY_CAST(FATALS AS INTEGER) AS fatals
FROM bronze.bronze_accident
WHERE ST_CASE IS NOT NULL AND YEAR IS NOT NULL
  AND NOT EXISTS (
      SELECT 1 FROM silver.silver_accident s
      WHERE s.st_case = TRY_CAST(bronze.bronze_accident.ST_CASE AS INTEGER)
        AND s.year = TRY_CAST(bronze.bronze_accident.YEAR AS INTEGER)
  );
