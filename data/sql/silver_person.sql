CREATE SCHEMA IF NOT EXISTS silver;

CREATE OR REPLACE TABLE silver.silver_person AS
SELECT
    TRY_CAST(STATE AS INTEGER) AS state,
    STATENAME,
    TRY_CAST(ST_CASE AS INTEGER) AS st_case,
    TRY_CAST(VEH_NO AS INTEGER) AS veh_no,
    TRY_CAST(PER_NO AS INTEGER) AS per_no,
    TRY_CAST(VE_FORMS AS INTEGER) AS ve_forms,
    TRY_CAST(COUNTY AS INTEGER) AS county,
    TRY_CAST(MONTH AS INTEGER) AS month,
    MONTHNAME,
    TRY_CAST(DAY AS INTEGER) AS day,
    DAYNAME,
    TRY_CAST(HOUR AS INTEGER) AS hour,
    HOURNAME,
    TRY_CAST(MINUTE AS INTEGER) AS minute,
    MINUTENAME,
    TRY_CAST(HARM_EV AS INTEGER) AS harm_ev,
    HARM_EVNAME,
    TRY_CAST(MAN_COLL AS INTEGER) AS man_coll,
    MAN_COLLNAME,
    TRY_CAST(SCH_BUS AS INTEGER) AS sch_bus,
    SCH_BUSNAME,
    TRY_CAST(RUR_URB AS INTEGER) AS rur_urb,
    RUR_URBNAME,
    TRY_CAST(FUNC_SYS AS INTEGER) AS func_sys,
    FUNC_SYSNAME,
    TRY_CAST(MOD_YEAR AS INTEGER) AS mod_year,
    MOD_YEARNAME,
    TRY_CAST(VPICMAKE AS INTEGER) AS vpicmake,
    VPICMAKENAME,
    TRY_CAST(VPICMODEL AS INTEGER) AS vpicmodel,
    VPICMODELNAME,
    TRY_CAST(VPICBODYCLASS AS INTEGER) AS vpicbodyclass,
    VPICBODYCLASSNAME,
    TRY_CAST(MAKE AS INTEGER) AS make,
    MAKENAME,
    TRY_CAST(BODY_TYP AS INTEGER) AS body_typ,
    BODY_TYPNAME,
    TRY_CAST(ICFINALBODY AS INTEGER) AS icfinalbody,
    ICFINALBODYNAME,
    TRY_CAST(GVWR_FROM AS INTEGER) AS gvwr_from,
    GVWR_FROMNAME,
    TRY_CAST(GVWR_TO AS INTEGER) AS gvwr_to,
    GVWR_TONAME,
    TRY_CAST(TOW_VEH AS INTEGER) AS tow_veh,
    TOW_VEHNAME,
    TRY_CAST(SPEC_USE AS INTEGER) AS spec_use,
    SPEC_USENAME,
    TRY_CAST(EMER_USE AS INTEGER) AS emer_use,
    EMER_USENAME,
    TRY_CAST(ROLLOVER AS INTEGER) AS rollover,
    ROLLOVERNAME,
    TRY_CAST(IMPACT1 AS INTEGER) AS impact1,
    IMPACT1NAME,
    TRY_CAST(FIRE_EXP AS INTEGER) AS fire_exp,
    FIRE_EXPNAME,
    MAK_MOD,
    MAK_MODNAME,
    TRY_CAST(AGE AS INTEGER) AS age,
    AGENAME,
    TRY_CAST(SEX AS INTEGER) AS sex,
    SEXNAME,
    TRY_CAST(PER_TYP AS INTEGER) AS per_typ,
    PER_TYPNAME,
    TRY_CAST(INJ_SEV AS INTEGER) AS inj_sev,
    INJ_SEVNAME,
    TRY_CAST(SEAT_POS AS INTEGER) AS seat_pos,
    SEAT_POSNAME,
    TRY_CAST(REST_USE AS INTEGER) AS rest_use,
    REST_USENAME,
    TRY_CAST(REST_MIS AS INTEGER) AS rest_mis,
    REST_MISNAME,
    TRY_CAST(HELM_USE AS INTEGER) AS helm_use,
    HELM_USENAME,
    TRY_CAST(HELM_MIS AS INTEGER) AS helm_mis,
    HELM_MISNAME,
    TRY_CAST(AIR_BAG AS INTEGER) AS air_bag,
    AIR_BAGNAME,
    TRY_CAST(EJECTION AS INTEGER) AS ejection,
    EJECTIONNAME,
    TRY_CAST(EJ_PATH AS INTEGER) AS ej_path,
    EJ_PATHNAME,
    TRY_CAST(EXTRICAT AS INTEGER) AS extricat,
    EXTRICATNAME,
    TRY_CAST(DRINKING AS INTEGER) AS drinking,
    DRINKINGNAME,
    TRY_CAST(ALC_STATUS AS INTEGER) AS alc_status,
    ALC_STATUSNAME,
    TRY_CAST(ATST_TYP AS INTEGER) AS atst_typ,
    ATST_TYPNAME,
    TRY_CAST(ALC_RES AS INTEGER) AS alc_res,
    ALC_RESNAME,
    TRY_CAST(DRUGS AS INTEGER) AS drugs,
    DRUGSNAME,
    TRY_CAST(DSTATUS AS INTEGER) AS dstatus,
    DSTATUSNAME,
    TRY_CAST(HOSPITAL AS INTEGER) AS hospital,
    HOSPITALNAME,
    TRY_CAST(DOA AS INTEGER) AS doa,
    DOANAME,
    TRY_CAST(DEATH_MO AS INTEGER) AS death_mo,
    DEATH_MONAME,
    TRY_CAST(DEATH_DA AS INTEGER) AS death_da,
    DEATH_DANAME,
    TRY_CAST(DEATH_YR AS INTEGER) AS death_yr,
    DEATH_YRNAME,
    TRY_CAST(DEATH_TM AS INTEGER) AS death_tm,
    DEATH_TMNAME,
    TRY_CAST(DEATH_HR AS INTEGER) AS death_hr,
    DEATH_HRNAME,
    TRY_CAST(DEATH_MN AS INTEGER) AS death_mn,
    DEATH_MNNAME,
    TRY_CAST(LAG_HRS AS INTEGER) AS lag_hrs,
    LAG_HRSNAME,
    TRY_CAST(LAG_MINS AS INTEGER) AS lag_mins,
    LAG_MINSNAME,
    TRY_CAST(STR_VEH AS INTEGER) AS str_veh,
    DEVTYPE,
    DEVTYPENAME,
    DEVMOTOR,
    DEVMOTORNAME,
    LOCATION,
    LOCATIONNAME,
    TRY_CAST(WORK_INJ AS INTEGER) AS work_inj,
    WORK_INJNAME,
    TRY_CAST(HISPANIC AS INTEGER) AS hispanic,
    HISPANICNAME
FROM bronze.bronze_person
WHERE ST_CASE IS NOT NULL AND VEH_NO IS NOT NULL AND PER_NO IS NOT NULL;
