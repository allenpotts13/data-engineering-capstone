CREATE SCHEMA IF NOT EXISTS silver;

INSERT INTO silver.silver_vehicle
SELECT
        TRY_CAST(STATE AS INTEGER) AS STATE,
        STATENAME,
        TRY_CAST(ST_CASE AS INTEGER) AS ST_CASE,
        TRY_CAST(VEH_NO AS INTEGER) AS VEH_NO,
        TRY_CAST(VE_FORMS AS INTEGER) AS VE_FORMS,
        TRY_CAST(MONTH AS INTEGER) AS MONTH,
        MONTHNAME,
        TRY_CAST(DAY AS INTEGER) AS DAY,
        DAYNAME,
        TRY_CAST(HOUR AS INTEGER) AS HOUR,
        HOURNAME,
        TRY_CAST(MINUTE AS INTEGER) AS MINUTE,
        MINUTENAME,
        TRY_CAST(HARM_EV AS INTEGER) AS HARM_EV,
        HARM_EVNAME,
        TRY_CAST(MAN_COLL AS INTEGER) AS MAN_COLL,
        MAN_COLLNAME,
        TRY_CAST(NUMOCCS AS INTEGER) AS NUMOCCS,
        NUMOCCSNAME,
        TRY_CAST(UNITTYPE AS INTEGER) AS UNITTYPE,
        UNITTYPENAME,
        TRY_CAST(HIT_RUN AS INTEGER) AS HIT_RUN,
        HIT_RUNNAME,
        TRY_CAST(REG_STAT AS INTEGER) AS REG_STAT,
        REG_STATNAME,
        TRY_CAST(OWNER AS INTEGER) AS OWNER,
        OWNERNAME,
        VIN,
        VINNAME,
        TRY_CAST(MOD_YEAR AS INTEGER) AS MOD_YEAR,
        MOD_YEARNAME,
        TRY_CAST(VPICMAKE AS INTEGER) AS VPICMAKE,
        VPICMAKENAME,
        TRY_CAST(VPICMODEL AS INTEGER) AS VPICMODEL,
        VPICMODELNAME,
        TRY_CAST(VPICBODYCLASS AS INTEGER) AS VPICBODYCLASS,
        VPICBODYCLASSNAME,
        TRY_CAST(MAKE AS INTEGER) AS MAKE,
        MAKENAME,
        TRY_CAST(BODY_TYP AS INTEGER) AS BODY_TYP,
        BODY_TYPNAME,
        TRY_CAST(ICFINALBODY AS INTEGER) AS ICFINALBODY,
        ICFINALBODYNAME,
        TRY_CAST(GVWR_FROM AS INTEGER) AS GVWR_FROM,
        GVWR_FROMNAME,
        TRY_CAST(GVWR_TO AS INTEGER) AS GVWR_TO,
        GVWR_TONAME,
        TRY_CAST(TOW_VEH AS INTEGER) AS TOW_VEH,
        TOW_VEHNAME,
        TRLR1VIN,
        TRLR1VINNAME,
        TRLR2VIN,
        TRLR2VINNAME,
        TRLR3VIN,
        TRLR3VINNAME,
        TRY_CAST(TRLR1GVWR AS INTEGER) AS TRLR1GVWR,
        TRLR1GVWRNAME,
        TRY_CAST(TRLR2GVWR AS INTEGER) AS TRLR2GVWR,
        TRLR2GVWRNAME,
        TRY_CAST(TRLR3GVWR AS INTEGER) AS TRLR3GVWR,
        TRLR3GVWRNAME,
        TRY_CAST(J_KNIFE AS INTEGER) AS J_KNIFE,
        J_KNIFENAME,
        MCARR_ID,
        MCARR_IDNAME,
        MCARR_I1,
        MCARR_I1NAME,
        MCARR_I2,
        MCARR_I2NAME,
        TRY_CAST(V_CONFIG AS INTEGER) AS V_CONFIG,
        V_CONFIGNAME,
        TRY_CAST(CARGO_BT AS INTEGER) AS CARGO_BT,
        CARGO_BTNAME,
        TRY_CAST(HAZ_INV AS INTEGER) AS HAZ_INV,
        HAZ_INVNAME,
        TRY_CAST(HAZ_PLAC AS INTEGER) AS HAZ_PLAC,
        HAZ_PLACNAME,
        HAZ_ID,
        HAZ_IDNAME,
        HAZ_CNO,
        HAZ_CNONAME,
        TRY_CAST(HAZ_REL AS INTEGER) AS HAZ_REL,
        HAZ_RELNAME,
        TRY_CAST(BUS_USE AS INTEGER) AS BUS_USE,
        BUS_USENAME,
        TRY_CAST(SPEC_USE AS INTEGER) AS SPEC_USE,
        SPEC_USENAME,
        TRY_CAST(EMER_USE AS INTEGER) AS EMER_USE,
        EMER_USENAME,
        TRY_CAST(TRAV_SP AS INTEGER) AS TRAV_SP,
        TRAV_SPNAME,
        TRY_CAST(UNDEROVERRIDE AS INTEGER) AS UNDEROVERRIDE,
        UNDEROVERRIDENAME,
        TRY_CAST(ROLLOVER AS INTEGER) AS ROLLOVER,
        ROLLOVERNAME,
        TRY_CAST(ROLINLOC AS INTEGER) AS ROLINLOC,
        ROLINLOCNAME,
        TRY_CAST(IMPACT1 AS INTEGER) AS IMPACT1,
        IMPACT1NAME,
        TRY_CAST(DEFORMED AS INTEGER) AS DEFORMED,
        DEFORMEDNAME,
        TRY_CAST(TOWED AS INTEGER) AS TOWED,
        TOWEDNAME,
        TRY_CAST(M_HARM AS INTEGER) AS M_HARM,
        M_HARMNAME,
        TRY_CAST(FIRE_EXP AS INTEGER) AS FIRE_EXP,
        FIRE_EXPNAME,
        MAK_MOD,
        MAK_MODNAME,
        VIN_1,
        VIN_2,
        VIN_3,
        VIN_4,
        VIN_5,
        VIN_6,
        VIN_7,
        VIN_8,
        VIN_9,
        VIN_10,
        VIN_11,
        VIN_12,
        TRY_CAST(DR_DRINK AS INTEGER) AS DR_DRINK,
        DR_DRINKNAME,
        TRY_CAST(DR_PRES AS INTEGER) AS DR_PRES,
        DR_PRESNAME,
        TRY_CAST(L_STATE AS INTEGER) AS L_STATE,
        L_STATENAME,
        DR_ZIP,
        DR_ZIPNAME,
        TRY_CAST(L_TYPE AS INTEGER) AS L_TYPE,
        L_TYPENAME,
        TRY_CAST(L_STATUS AS INTEGER) AS L_STATUS,
        L_STATUSNAME,
        TRY_CAST(CDL_STAT AS INTEGER) AS CDL_STAT,
        CDL_STATNAME,
        TRY_CAST(L_ENDORS AS INTEGER) AS L_ENDORS,
        L_ENDORSNAME,
        TRY_CAST(L_COMPL AS INTEGER) AS L_COMPL,
        L_COMPLNAME,
        TRY_CAST(L_RESTRI AS INTEGER) AS L_RESTRI,
        L_RESTRINAME,
        TRY_CAST(DR_HGT AS INTEGER) AS DR_HGT,
        DR_HGTNAME,
        TRY_CAST(DR_WGT AS INTEGER) AS DR_WGT,
        DR_WGTNAME,
        TRY_CAST(PREV_ACC AS INTEGER) AS PREV_ACC,
        PREV_ACCNAME,
        TRY_CAST(PREV_SUS1 AS INTEGER) AS PREV_SUS1,
        PREV_SUS1NAME,
        TRY_CAST(PREV_SUS2 AS INTEGER) AS PREV_SUS2,
        PREV_SUS2NAME,
        TRY_CAST(PREV_SUS3 AS INTEGER) AS PREV_SUS3,
        PREV_SUS3NAME,
        TRY_CAST(PREV_DWI AS INTEGER) AS PREV_DWI,
        PREV_DWINAME,
        TRY_CAST(PREV_SPD AS INTEGER) AS PREV_SPD,
        PREV_SPDNAME,
        TRY_CAST(PREV_OTH AS INTEGER) AS PREV_OTH,
        PREV_OTHNAME,
        TRY_CAST(FIRST_MO AS INTEGER) AS FIRST_MO,
        FIRST_MONAME,
        TRY_CAST(FIRST_YR AS INTEGER) AS FIRST_YR,
        FIRST_YRNAME,
        TRY_CAST(LAST_MO AS INTEGER) AS LAST_MO,
        LAST_MONAME,
        TRY_CAST(LAST_YR AS INTEGER) AS LAST_YR,
        LAST_YRNAME,
        TRY_CAST(SPEEDREL AS INTEGER) AS SPEEDREL,
        SPEEDRELNAME,
        TRY_CAST(VTRAFWAY AS INTEGER) AS VTRAFWAY,
        VTRAFWAYNAME,
        TRY_CAST(VNUM_LAN AS INTEGER) AS VNUM_LAN,
        VNUM_LANNAME,
        TRY_CAST(VSPD_LIM AS INTEGER) AS VSPD_LIM,
        VSPD_LIMNAME,
        TRY_CAST(VALIGN AS INTEGER) AS VALIGN,
        VALIGNNAME,
        TRY_CAST(VPROFILE AS INTEGER) AS VPROFILE,
        VPROFILENAME,
        TRY_CAST(VPAVETYP AS INTEGER) AS VPAVETYP,
        VPAVETYPNAME,
        TRY_CAST(VSURCOND AS INTEGER) AS VSURCOND,
        VSURCONDNAME,
        TRY_CAST(VTRAFCON AS INTEGER) AS VTRAFCON,
        VTRAFCONNAME,
        TRY_CAST(VTCONT_F AS INTEGER) AS VTCONT_F,
        VTCONT_FNAME,
        TRY_CAST(P_CRASH1 AS INTEGER) AS P_CRASH1,
        P_CRASH1NAME,
        TRY_CAST(P_CRASH2 AS INTEGER) AS P_CRASH2,
        P_CRASH2NAME,
        TRY_CAST(P_CRASH3 AS INTEGER) AS P_CRASH3,
        P_CRASH3NAME,
        TRY_CAST(PCRASH4 AS INTEGER) AS PCRASH4,
        PCRASH4NAME,
        TRY_CAST(PCRASH5 AS INTEGER) AS PCRASH5,
        PCRASH5NAME,
        TRY_CAST(ACC_TYPE AS INTEGER) AS ACC_TYPE,
        ACC_TYPENAME,
        TRY_CAST(ACC_CONFIG AS INTEGER) AS ACC_CONFIG,
        ACC_CONFIGNAME,
        MODEL,
        TRY_CAST(DEATHS AS INTEGER) AS DEATHS
FROM bronze.bronze_vehicle
WHERE ST_CASE IS NOT NULL AND VEH_NO IS NOT NULL
        AND NOT EXISTS (
                SELECT 1 FROM silver.silver_vehicle s
                WHERE s.st_case = TRY_CAST(bronze.bronze_vehicle.ST_CASE AS INTEGER)
                        AND s.veh_no = TRY_CAST(bronze.bronze_vehicle.VEH_NO AS INTEGER)
        );
