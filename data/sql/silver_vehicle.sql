CREATE SCHEMA IF NOT EXISTS silver;

CREATE OR REPLACE TABLE silver.silver_vehicle AS
SELECT
    TRY_CAST(STATE AS INTEGER) AS state,
    STATENAME,
    TRY_CAST(ST_CASE AS INTEGER) AS st_case,
    TRY_CAST(VEH_NO AS INTEGER) AS veh_no,
    TRY_CAST(VE_FORMS AS INTEGER) AS ve_forms,
    TRY_CAST(MONTH AS INTEGER) AS month,
    MONTHNAME,
    TRY_CAST(DAY AS INTEGER) AS day,
    DAYNAME,
    TRY_CAST(HOUR AS INTEGER) AS hour,
    HOURNAME,
    TRY_CAST(MINUTE AS INTEGER) AS minute,
    MINUTENAME,
    TRY_CAST(HARM_EV AS INTEGER) AS harm_ev,
    HARM_EVNAME,
    TRY_CAST(MAN_COLL AS INTEGER) AS man_coll,
    MAN_COLLNAME,
    TRY_CAST(NUMOCCS AS INTEGER) AS numoccs,
    NUMOCCSNAME,
    TRY_CAST(UNITTYPE AS INTEGER) AS unittype,
    UNITTYPENAME,
    TRY_CAST(HIT_RUN AS INTEGER) AS hit_run,
    HIT_RUNNAME,
    TRY_CAST(REG_STAT AS INTEGER) AS reg_stat,
    REG_STATNAME,
    TRY_CAST(OWNER AS INTEGER) AS owner,
    OWNERNAME,
    VIN,
    VINNAME,
    TRY_CAST(MOD_YEAR AS INTEGER) AS mod_year,
    MOD_YEARNAME,
    TRY_CAST(VPICMAKE AS INTEGER) AS vpicmake,
    VPICMAKENAME,
    TRY_CAST(VPICMODEL AS INTEGER) AS vpicmodel,
    VPICMODELNAME,
    TRY_CAST(VPICBODYCLASS AS INTEGER) AS vpicbodyclass,
    VPICBODYCLASSNAME,
    TRY_CAST(MAKE AS INTEGER) AS make,
    MAKENAME,
    TRY_CAST(BODY_TYP AS INTEGER) AS body_typ,
    BODY_TYPNAME,
    TRY_CAST(ICFINALBODY AS INTEGER) AS icfinalbody,
    ICFINALBODYNAME,
    TRY_CAST(GVWR_FROM AS INTEGER) AS gvwr_from,
    GVWR_FROMNAME,
    TRY_CAST(GVWR_TO AS INTEGER) AS gvwr_to,
    GVWR_TONAME,
    TRY_CAST(TOW_VEH AS INTEGER) AS tow_veh,
    TOW_VEHNAME,
    TRLR1VIN,
    TRLR1VINNAME,
    TRLR2VIN,
    TRLR2VINNAME,
    TRLR3VIN,
    TRLR3VINNAME,
    TRY_CAST(TRLR1GVWR AS INTEGER) AS trlr1gvwr,
    TRLR1GVWRNAME,
    TRY_CAST(TRLR2GVWR AS INTEGER) AS trlr2gvwr,
    TRLR2GVWRNAME,
    TRY_CAST(TRLR3GVWR AS INTEGER) AS trlr3gvwr,
    TRLR3GVWRNAME,
    TRY_CAST(J_KNIFE AS INTEGER) AS j_knife,
    J_KNIFENAME,
    MCARR_ID,
    MCARR_IDNAME,
    MCARR_I1,
    MCARR_I1NAME,
    MCARR_I2,
    MCARR_I2NAME,
    TRY_CAST(V_CONFIG AS INTEGER) AS v_config,
    V_CONFIGNAME,
    TRY_CAST(CARGO_BT AS INTEGER) AS cargo_bt,
    CARGO_BTNAME,
    TRY_CAST(HAZ_INV AS INTEGER) AS haz_inv,
    HAZ_INVNAME,
    TRY_CAST(HAZ_PLAC AS INTEGER) AS haz_plac,
    HAZ_PLACNAME,
    HAZ_ID,
    HAZ_IDNAME,
    HAZ_CNO,
    HAZ_CNONAME,
    TRY_CAST(HAZ_REL AS INTEGER) AS haz_rel,
    HAZ_RELNAME,
    TRY_CAST(BUS_USE AS INTEGER) AS bus_use,
    BUS_USENAME,
    TRY_CAST(SPEC_USE AS INTEGER) AS spec_use,
    SPEC_USENAME,
    TRY_CAST(EMER_USE AS INTEGER) AS emer_use,
    EMER_USENAME,
    TRY_CAST(TRAV_SP AS INTEGER) AS trav_sp,
    TRAV_SPNAME,
    TRY_CAST(UNDEROVERRIDE AS INTEGER) AS underoverride,
    UNDEROVERRIDENAME,
    TRY_CAST(ROLLOVER AS INTEGER) AS rollover,
    ROLLOVERNAME,
    TRY_CAST(ROLINLOC AS INTEGER) AS rolinloc,
    ROLINLOCNAME,
    TRY_CAST(IMPACT1 AS INTEGER) AS impact1,
    IMPACT1NAME,
    TRY_CAST(DEFORMED AS INTEGER) AS deformed,
    DEFORMEDNAME,
    TRY_CAST(TOWED AS INTEGER) AS towed,
    TOWEDNAME,
    TRY_CAST(M_HARM AS INTEGER) AS m_harm,
    M_HARMNAME,
    TRY_CAST(FIRE_EXP AS INTEGER) AS fire_exp,
    FIRE_EXPNAME,
    MAK_MOD,
    MAK_MODNAME,
    VIN_1,
    VIN_2,
    VIN_3,
    VIN_4,
    VIN_5,
    VIN_6,
    VIN_7,
    VIN_8,
    VIN_9,
    VIN_10,
    VIN_11,
    VIN_12,
    TRY_CAST(DR_DRINK AS INTEGER) AS dr_drink,
    DR_DRINKNAME,
    TRY_CAST(DR_PRES AS INTEGER) AS dr_pres,
    DR_PRESNAME,
    TRY_CAST(L_STATE AS INTEGER) AS l_state,
    L_STATENAME,
    DR_ZIP,
    DR_ZIPNAME,
    TRY_CAST(L_TYPE AS INTEGER) AS l_type,
    L_TYPENAME,
    TRY_CAST(L_STATUS AS INTEGER) AS l_status,
    L_STATUSNAME,
    TRY_CAST(CDL_STAT AS INTEGER) AS cdl_stat,
    CDL_STATNAME,
    TRY_CAST(L_ENDORS AS INTEGER) AS l_endors,
    L_ENDORSNAME,
    TRY_CAST(L_COMPL AS INTEGER) AS l_compl,
    L_COMPLNAME,
    TRY_CAST(L_RESTRI AS INTEGER) AS l_restri,
    L_RESTRINAME,
    TRY_CAST(DR_HGT AS INTEGER) AS dr_hgt,
    DR_HGTNAME,
    TRY_CAST(DR_WGT AS INTEGER) AS dr_wgt,
    DR_WGTNAME,
    TRY_CAST(PREV_ACC AS INTEGER) AS prev_acc,
    PREV_ACCNAME,
    TRY_CAST(PREV_SUS1 AS INTEGER) AS prev_sus1,
    PREV_SUS1NAME,
    TRY_CAST(PREV_SUS2 AS INTEGER) AS prev_sus2,
    PREV_SUS2NAME,
    TRY_CAST(PREV_SUS3 AS INTEGER) AS prev_sus3,
    PREV_SUS3NAME,
    TRY_CAST(PREV_DWI AS INTEGER) AS prev_dwi,
    PREV_DWINAME,
    TRY_CAST(PREV_SPD AS INTEGER) AS prev_spd,
    PREV_SPDNAME,
    TRY_CAST(PREV_OTH AS INTEGER) AS prev_oth,
    PREV_OTHNAME,
    TRY_CAST(FIRST_MO AS INTEGER) AS first_mo,
    FIRST_MONAME,
    TRY_CAST(FIRST_YR AS INTEGER) AS first_yr,
    FIRST_YRNAME,
    TRY_CAST(LAST_MO AS INTEGER) AS last_mo,
    LAST_MONAME,
    TRY_CAST(LAST_YR AS INTEGER) AS last_yr,
    LAST_YRNAME,
    TRY_CAST(SPEEDREL AS INTEGER) AS speedrel,
    SPEEDRELNAME,
    TRY_CAST(VTRAFWAY AS INTEGER) AS vtrafway,
    VTRAFWAYNAME,
    TRY_CAST(VNUM_LAN AS INTEGER) AS vnum_lan,
    VNUM_LANNAME,
    TRY_CAST(VSPD_LIM AS INTEGER) AS vspd_lim,
    VSPD_LIMNAME,
    TRY_CAST(VALIGN AS INTEGER) AS valign,
    VALIGNNAME,
    TRY_CAST(VPROFILE AS INTEGER) AS vprofile,
    VPROFILENAME,
    TRY_CAST(VPAVETYP AS INTEGER) AS vpavetyp,
    VPAVETYPNAME,
    TRY_CAST(VSURCOND AS INTEGER) AS vsurcond,
    VSURCONDNAME,
    TRY_CAST(VTRAFCON AS INTEGER) AS vtrafcon,
    VTRAFCONNAME,
    TRY_CAST(VTCONT_F AS INTEGER) AS vtcont_f,
    VTCONT_FNAME,
    TRY_CAST(P_CRASH1 AS INTEGER) AS p_crash1,
    P_CRASH1NAME,
    TRY_CAST(P_CRASH2 AS INTEGER) AS p_crash2,
    P_CRASH2NAME,
    TRY_CAST(P_CRASH3 AS INTEGER) AS p_crash3,
    P_CRASH3NAME,
    TRY_CAST(PCRASH4 AS INTEGER) AS pcrash4,
    PCRASH4NAME,
    TRY_CAST(PCRASH5 AS INTEGER) AS pcrash5,
    PCRASH5NAME,
    TRY_CAST(ACC_TYPE AS INTEGER) AS acc_type,
    ACC_TYPENAME,
    TRY_CAST(ACC_CONFIG AS INTEGER) AS acc_config,
    ACC_CONFIGNAME,
    MODEL,
    TRY_CAST(DEATHS AS INTEGER) AS deaths
FROM bronze.bronze_vehicle
WHERE ST_CASE IS NOT NULL AND VEH_NO IS NOT NULL;
