CREATE SCHEMA IF NOT EXISTS silver;

INSERT INTO silver.silver_parkwork
SELECT
    TRY_CAST(STATE AS INTEGER) AS state,
    STATENAME,
    TRY_CAST(ST_CASE AS INTEGER) AS st_case,
    TRY_CAST(VEH_NO AS INTEGER) AS veh_no,
    TRY_CAST(PVE_FORMS AS INTEGER) AS pve_forms,
    TRY_CAST(PMONTH AS INTEGER) AS pmonth,
    PMONTHNAME,
    TRY_CAST(PDAY AS INTEGER) AS pday,
    PDAYNAME,
    TRY_CAST(PHOUR AS INTEGER) AS phour,
    PHOURNAME,
    TRY_CAST(PMINUTE AS INTEGER) AS pminute,
    PMINUTENAME,
    TRY_CAST(PHARM_EV AS INTEGER) AS pharm_ev,
    PHARM_EVNAME,
    TRY_CAST(PMAN_COLL AS INTEGER) AS pman_coll,
    PMAN_COLLNAME,
    TRY_CAST(PNUMOCCS AS INTEGER) AS pnumoccs,
    PNUMOCCSNAME,
    TRY_CAST(PTYPE AS INTEGER) AS ptype,
    PTYPENAME,
    TRY_CAST(PHIT_RUN AS INTEGER) AS phit_run,
    PHIT_RUNNAME,
    TRY_CAST(PREG_STAT AS INTEGER) AS preg_stat,
    PREG_STATNAME,
    TRY_CAST(POWNER AS INTEGER) AS powner,
    POWNERNAME,
    PVIN,
    PVINNAME,
    TRY_CAST(PMODYEAR AS INTEGER) AS pmodyear,
    PMODYEARNAME,
    TRY_CAST(PVPICMAKE AS INTEGER) AS pvpicmake,
    PVPICMAKENAME,
    TRY_CAST(PVPICMODEL AS INTEGER) AS pvpicmodel,
    PVPICMODELNAME,
    TRY_CAST(PVPICBODYCLASS AS INTEGER) AS pvpicbodyclass,
    PVPICBODYCLASSNAME,
    TRY_CAST(PMAKE AS INTEGER) AS pmake,
    PMAKENAME,
    TRY_CAST(PMODEL AS INTEGER) AS pmodel,
    TRY_CAST(PBODYTYP AS INTEGER) AS pbodytyp,
    PBODYTYPNAME,
    TRY_CAST(PICFINALBODY AS INTEGER) AS picfinalbody,
    PICFINALBODYNAME,
    TRY_CAST(PGVWR_FROM AS INTEGER) AS pgvwr_from,
    PGVWR_FROMNAME,
    TRY_CAST(PGVWR_TO AS INTEGER) AS pgvwr_to,
    PGVWR_TONAME,
    TRY_CAST(PTRAILER AS INTEGER) AS ptrailer,
    PTRAILERNAME,
    PTRLR1VIN,
    PTRLR1VINNAME,
    PTRLR2VIN,
    PTRLR2VINNAME,
    PTRLR3VIN,
    PTRLR3VINNAME,
    TRY_CAST(PTRLR1GVWR AS INTEGER) AS ptrlr1gvwr,
    PTRLR1GVWRNAME,
    TRY_CAST(PTRLR2GVWR AS INTEGER) AS ptrlr2gvwr,
    PTRLR2GVWRNAME,
    TRY_CAST(PTRLR3GVWR AS INTEGER) AS ptrlr3gvwr,
    PTRLR3GVWRNAME,
    PMCARR_ID,
    PMCARR_IDNAME,
    PMCARR_I1,
    PMCARR_I1NAME,
    PMCARR_I2,
    PMCARR_I2NAME,
    TRY_CAST(PV_CONFIG AS INTEGER) AS pv_config,
    PV_CONFIGNAME,
    TRY_CAST(PCARGTYP AS INTEGER) AS pcargtyp,
    PCARGTYPNAME,
    TRY_CAST(PHAZ_INV AS INTEGER) AS phaz_inv,
    PHAZ_INVNAME,
    PHAZPLAC,
    PHAZPLACNAME,
    PHAZ_ID,
    PHAZ_IDNAME,
    PHAZ_CNO,
    PHAZ_CNONAME,
    PHAZ_REL,
    PHAZ_RELNAME,
    TRY_CAST(PBUS_USE AS INTEGER) AS pbus_use,
    PBUS_USENAME,
    TRY_CAST(PSP_USE AS INTEGER) AS psp_use,
    PSP_USENAME,
    TRY_CAST(PEM_USE AS INTEGER) AS pem_use,
    PEM_USENAME,
    TRY_CAST(PUNDEROVERRIDE AS INTEGER) AS punderoverride,
    PUNDEROVERRIDENAME,
    TRY_CAST(PIMPACT1 AS INTEGER) AS pimpact1,
    PIMPACT1NAME,
    TRY_CAST(PVEH_SEV AS INTEGER) AS pveh_sev,
    PVEH_SEVNAME,
    TRY_CAST(PTOWED AS INTEGER) AS ptowed,
    PTOWEDNAME,
    TRY_CAST(PM_HARM AS INTEGER) AS pm_harm,
    PM_HARMNAME,
    TRY_CAST(PFIRE AS INTEGER) AS pfire,
    PFIRENAME,
    PMAK_MOD,
    PMAK_MODNAME,
    PVIN_1,
    PVIN_2,
    PVIN_3,
    PVIN_4,
    PVIN_5,
    PVIN_6,
    PVIN_7,
    PVIN_8,
    PVIN_9,
    PVIN_10,
    PVIN_11,
    PVIN_12,
    TRY_CAST(PDEATHS AS INTEGER) AS pdeaths
FROM bronze.bronze_parkwork
WHERE st_case IS NOT NULL AND veh_no IS NOT NULL
    AND NOT EXISTS (
        SELECT 1 FROM silver.silver_parkwork s
        WHERE s.st_case = TRY_CAST(bronze.bronze_parkwork.ST_CASE AS INTEGER)
            AND s.veh_no = TRY_CAST(bronze.bronze_parkwork.VEH_NO AS INTEGER)
    );
