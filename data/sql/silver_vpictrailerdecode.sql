CREATE OR REPLACE TABLE silver_vpictrailerdecode AS
SELECT
    TRY_CAST(state AS INTEGER) AS state,
    LOWER(statename) AS statename,
    TRY_CAST(st_case AS INTEGER) AS st_case,
    TRY_CAST(veh_no AS INTEGER) AS veh_no,
    TRY_CAST(trailer_no AS INTEGER) AS trailer_no,
    vehicledescriptor AS vehicle_descriptor,
    vindecodedon AS vin_decoded_on,
    TRY_CAST(vindecodeerror AS INTEGER) AS vin_decode_error,
    TRY_CAST(vehicletypeid AS INTEGER) AS vehicle_type_id,
    LOWER(vehicletype) AS vehicle_type,
    TRY_CAST(manufacturerfullnameid AS INTEGER) AS manufacturer_fullname_id,
    LOWER(manufacturerfullname) AS manufacturer_fullname,
    TRY_CAST(makeid AS INTEGER) AS make_id,
    LOWER(make) AS make,
    TRY_CAST(modelid AS INTEGER) AS model_id,
    LOWER(model) AS model,
    TRY_CAST(modelyear AS INTEGER) AS model_year,
    LOWER(series) AS series,
    LOWER(trim) AS trim,
    TRY_CAST(plantcountryid AS INTEGER) AS plant_country_id,
    LOWER(plantcountry) AS plant_country,
    LOWER(plantstate) AS plant_state,
    LOWER(plantcity) AS plant_city,
    LOWER(plantcompanyname) AS plant_company_name,
    TRY_CAST(nonlanduseid AS INTEGER) AS non_land_use_id,
    LOWER(nonlanduse) AS non_land_use,
    LOWER(note) AS note,
    TRY_CAST(bodyclassid AS INTEGER) AS body_class_id,
    LOWER(bodyclass) AS body_class,
    TRY_CAST(grossvehicleweightratingfromid AS INTEGER) AS gross_vehicle_weight_rating_from_id,
    LOWER(grossvehicleweightratingfrom) AS gross_vehicle_weight_rating_from,
    TRY_CAST(grossvehicleweightratingtoid AS INTEGER) AS gross_vehicle_weight_rating_to_id,
    LOWER(grossvehicleweightratingto) AS gross_vehicle_weight_rating_to,
    TRY_CAST(trailerbodytypeid AS INTEGER) AS trailer_body_type_id,
    LOWER(trailerbodytype) AS trailer_body_type,
    TRY_CAST(trailertypeconnectionid AS INTEGER) AS trailer_type_connection_id,
    LOWER(trailertypeconnection) AS trailer_type_connection,
    TRY_CAST(trailerlengthft AS DOUBLE) AS trailer_length_ft,
    LOWER(othertrailerinfo) AS other_trailer_info,
    TRY_CAST(axlescount AS INTEGER) AS axles_count,
    TRY_CAST(axleconfigurationid AS INTEGER) AS axle_configuration_id,
    LOWER(axleconfiguration) AS axle_configuration
FROM bronze_vpictrailerdecode
WHERE st_case IS NOT NULL AND veh_no IS NOT NULL AND trailer_no IS NOT NULL;
