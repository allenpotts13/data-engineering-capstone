CREATE SCHEMA IF NOT EXISTS silver;

CREATE OR REPLACE TABLE silver.silver_vevent AS
SELECT
    TRY_CAST(STATE AS INTEGER) AS state,
    STATENAME,
    TRY_CAST(ST_CASE AS INTEGER) AS st_case,
    TRY_CAST(EVENTNUM AS INTEGER) AS eventnum,
    TRY_CAST(VEH_NO AS INTEGER) AS veh_no,
    TRY_CAST(VEVENTNUM AS INTEGER) AS veventnum,
    TRY_CAST(VNUMBER1 AS INTEGER) AS vnumber1,
    TRY_CAST(AOI1 AS INTEGER) AS aoi1,
    AOI1NAME,
    TRY_CAST(SOE AS INTEGER) AS soe,
    SOENAME,
    TRY_CAST(VNUMBER2 AS INTEGER) AS vnumber2,
    VNUMBER2NAME,
    TRY_CAST(AOI2 AS INTEGER) AS aoi2,
    AOI2NAME
FROM bronze.bronze_vevent
WHERE ST_CASE IS NOT NULL AND VEH_NO IS NOT NULL AND EVENTNUM IS NOT NULL;
