CREATE OR REPLACE TABLE silver_vpicdecode AS
SELECT
    TRY_CAST(state AS INTEGER) AS state,
    LOWER(statename) AS statename,
    TRY_CAST(st_case AS INTEGER) AS st_case,
    TRY_CAST(veh_no AS INTEGER) AS veh_no,
    vehicledescriptor AS vehicle_descriptor,
    vindecodedon AS vin_decoded_on,
    TRY_CAST(vindecodeerror AS INTEGER) AS vin_decode_error,
    TRY_CAST(vehicletypeid AS INTEGER) AS vehicle_type_id,
    LOWER(vehicletype) AS vehicle_type,
    TRY_CAST(manufacturerfullnameid AS INTEGER) AS manufacturer_fullname_id,
    LOWER(manufacturerfullname) AS manufacturer_fullname,
    TRY_CAST(makeid AS INTEGER) AS make_id,
    LOWER(make) AS make,
    TRY_CAST(modelid AS INTEGER) AS model_id,
    LOWER(model) AS model,
    TRY_CAST(modelyear AS INTEGER) AS model_year,
    LOWER(series) AS series,
    LOWER(trim) AS trim,
    LOWER(series2) AS series2,
    LOWER(trim2) AS trim2,
    TRY_CAST(plantcountryid AS INTEGER) AS plant_country_id,
    LOWER(plantcountry) AS plant_country,
    LOWER(plantstate) AS plant_state,
    LOWER(plantcity) AS plant_city,
    LOWER(plantcompanyname) AS plant_company_name,
    TRY_CAST(destinationmarketid AS INTEGER) AS destination_market_id,
    LOWER(destinationmarket) AS destination_market,
    TRY_CAST(baseprice AS DOUBLE) AS base_price,
    TRY_CAST(nonlanduseid AS INTEGER) AS non_land_use_id,
    LOWER(nonlanduse) AS non_land_use,
    LOWER(note) AS note,
    TRY_CAST(bodyclassid AS INTEGER) AS body_class_id,
    LOWER(bodyclass) AS body_class,
    TRY_CAST(doorscount AS INTEGER) AS doors_count,
    TRY_CAST(windows AS INTEGER) AS windows,
    TRY_CAST(wheelbasetypeid AS INTEGER) AS wheelbase_type_id,
    LOWER(wheelbasetype) AS wheelbase_type,
    TRY_CAST(trackwidthin AS DOUBLE) AS track_width_in,
    TRY_CAST(grossvehicleweightratingfromid AS INTEGER) AS gross_vehicle_weight_rating_from_id,
    LOWER(grossvehicleweightratingfrom) AS gross_vehicle_weight_rating_from,
    TRY_CAST(grossvehicleweightratingtoid AS INTEGER) AS gross_vehicle_weight_rating_to_id,
    LOWER(grossvehicleweightratingto) AS gross_vehicle_weight_rating_to,
    TRY_CAST(grosscombweightratingfromid AS INTEGER) AS gross_comb_weight_rating_from_id,
    LOWER(grosscombweightratingfrom) AS gross_comb_weight_rating_from,
    TRY_CAST(grosscombweightratingtoid AS INTEGER) AS gross_comb_weight_rating_to_id,
    LOWER(grosscombweightratingto) AS gross_comb_weight_rating_to,
    TRY_CAST(curbweightlb AS DOUBLE) AS curb_weight_lb,
    TRY_CAST(wheelbasein_from AS DOUBLE) AS wheelbase_in_from,
    TRY_CAST(wheelbasein_to AS DOUBLE) AS wheelbase_in_to,
    TRY_CAST(wheelscount AS INTEGER) AS wheels_count,
    TRY_CAST(wheelsizefrontin AS DOUBLE) AS wheel_size_front_in,
    TRY_CAST(wheelsizerearin AS DOUBLE) AS wheel_size_rear_in,
    TRY_CAST(truckbodycabtypeid AS INTEGER) AS truck_body_cab_type_id,
    LOWER(truckbodycabtype) AS truck_body_cab_type,
    TRY_CAST(truckbedtypeid AS INTEGER) AS truck_bed_type_id,
    LOWER(truckbedtype) AS truck_bed_type,
    TRY_CAST(truckbedlengthin AS DOUBLE) AS truck_bed_length_in,
    TRY_CAST(bustypeid AS INTEGER) AS bus_type_id,
    LOWER(bustype) AS bus_type,
    TRY_CAST(busfloorconfigurationtypeid AS INTEGER) AS bus_floor_configuration_type_id,
    LOWER(busfloorconfigurationtype) AS bus_floor_configuration_type,
    TRY_CAST(buslengthft AS DOUBLE) AS bus_length_ft,
    LOWER(otherbusinfo) AS other_bus_info,
    TRY_CAST(custommotorcycletypeid AS INTEGER) AS custom_motorcycle_type_id,
    LOWER(custommotorcycletype) AS custom_motorcycle_type,
    TRY_CAST(motorcyclesuspensiontypeid AS INTEGER) AS motorcycle_suspension_type_id,
    LOWER(motorcyclesuspensiontype) AS motorcycle_suspension_type,
    TRY_CAST(motorcyclechassistypeid AS INTEGER) AS motorcycle_chassis_type_id,
    LOWER(motorcyclechassistype) AS motorcycle_chassis_type,
    LOWER(othermotorcycleinfo) AS other_motorcycle_info,
    TRY_CAST(steeringlocationid AS INTEGER) AS steering_location_id,
    LOWER(steeringlocation) AS steering_location,
    TRY_CAST(entertainmentsystemid AS INTEGER) AS entertainment_system_id,
    LOWER(entertainmentsystem) AS entertainment_system,
    TRY_CAST(seatscount AS INTEGER) AS seats_count,
    TRY_CAST(seatrowscount AS INTEGER) AS seat_rows_count,
    TRY_CAST(transmissionspeeds AS INTEGER) AS transmission_speeds,
    TRY_CAST(transmissionstyleid AS INTEGER) AS transmission_style_id,
    LOWER(transmissionstyle) AS transmission_style,
    TRY_CAST(drivetypeid AS INTEGER) AS drive_type_id,
    LOWER(drivetype) AS drive_type,
    TRY_CAST(axlescount AS INTEGER) AS axles_count,
    TRY_CAST(axleconfigurationid AS INTEGER) AS axle_configuration_id,
    LOWER(axleconfiguration) AS axle_configuration,
    TRY_CAST(brakesystemtypeid AS INTEGER) AS brake_system_type_id,
    LOWER(brakesystemtype) AS brake_system_type,
    LOWER(brakesystemdesc) AS brake_system_desc,
    TRY_CAST(evdriveunitid AS INTEGER) AS ev_drive_unit_id,
    LOWER(evdriveunit) AS ev_drive_unit,
    TRY_CAST(batterykwh_from AS DOUBLE) AS battery_kwh_from,
    TRY_CAST(batterykwh_to AS DOUBLE) AS battery_kwh_to,
    TRY_CAST(batteryv_from AS DOUBLE) AS battery_v_from,
    TRY_CAST(batteryv_to AS DOUBLE) AS battery_v_to,
    TRY_CAST(batterya_from AS DOUBLE) AS battery_a_from,
    TRY_CAST(batterya_to AS DOUBLE) AS battery_a_to,
    TRY_CAST(batterypackspervehicle AS INTEGER) AS battery_packs_per_vehicle,
    TRY_CAST(batterymodulesperpack AS INTEGER) AS battery_modules_per_pack,
    TRY_CAST(batterycellspermodule AS INTEGER) AS battery_cells_per_module,
    TRY_CAST(batterytypeid AS INTEGER) AS battery_type_id,
    LOWER(batterytype) AS battery_type,
    LOWER(otherbatteryinfo) AS other_battery_info,
    TRY_CAST(chargerlevelid AS INTEGER) AS charger_level_id,
    LOWER(chargerlevel) AS charger_level,
    TRY_CAST(chargerpowerkw AS DOUBLE) AS charger_power_kw,
    LOWER(enginemanufacturer) AS engine_manufacturer,
    LOWER(enginemodel) AS engine_model,
    TRY_CAST(engineconfigurationid AS INTEGER) AS engine_configuration_id,
    LOWER(engineconfiguration) AS engine_configuration,
    TRY_CAST(enginepowerkw AS DOUBLE) AS engine_power_kw,
    TRY_CAST(enginestrokecycles AS INTEGER) AS engine_stroke_cycles,
    TRY_CAST(enginecylinderscount AS INTEGER) AS engine_cylinders_count,
    TRY_CAST(enginebrakehp_from AS DOUBLE) AS engine_brake_hp_from,
    TRY_CAST(enginebrakehp_to AS DOUBLE) AS engine_brake_hp_to,
    TRY_CAST(enginecoolingtypeid AS INTEGER) AS engine_cooling_type_id,
    LOWER(enginecoolingtype) AS engine_cooling_type,
    TRY_CAST(displacementci AS DOUBLE) AS displacement_ci,
    TRY_CAST(displacementcc AS DOUBLE) AS displacement_cc,
    TRY_CAST(displacementl AS DOUBLE) AS displacement_l,
    TRY_CAST(fueltypeprimaryid AS INTEGER) AS fuel_type_primary_id,
    LOWER(fueltypeprimary) AS fuel_type_primary,
    TRY_CAST(fueltypesecondaryid AS INTEGER) AS fuel_type_secondary_id,
    LOWER(fueltypesecondary) AS fuel_type_secondary,
    TRY_CAST(fueldeliveryinjectiontypeid AS INTEGER) AS fuel_delivery_injection_type_id,
    LOWER(fueldeliveryinjectiontype) AS fuel_delivery_injection_type,
    TRY_CAST(enginevalvetraindesignid AS INTEGER) AS engine_valve_train_design_id,
    LOWER(enginevalvetraindesign) AS engine_valve_train_design,
    TRY_CAST(engineelectrificationlevelid AS INTEGER) AS engine_electrification_level_id,
    LOWER(engineelectrificationlevel) AS engine_electrification_level,
    TRY_CAST(engineturboid AS INTEGER) AS engine_turbo_id,
    LOWER(engineturbo) AS engine_turbo,
    TRY_CAST(topspeedmph AS DOUBLE) AS top_speed_mph,
    LOWER(otherengineinfo) AS other_engine_info,
    TRY_CAST(seatbelttypeid AS INTEGER) AS seat_belt_type_id,
    LOWER(seatbelttype) AS seat_belt_type,
    TRY_CAST(pretensionerid AS INTEGER) AS pretensioner_id,
    LOWER(pretensioner) AS pretensioner,
    TRY_CAST(airbaglocfrontid AS INTEGER) AS airbag_loc_front_id,
    LOWER(airbaglocfront) AS airbag_loc_front,
    TRY_CAST(airbaglockneeid AS INTEGER) AS airbag_loc_knee_id,
    LOWER(airbaglocknee) AS airbag_loc_knee,
    TRY_CAST(airbaglocsideid AS INTEGER) AS airbag_loc_side_id,
    LOWER(airbaglocside) AS airbag_loc_side,
    TRY_CAST(airbagloccurtainid AS INTEGER) AS airbag_loc_curtain_id,
    LOWER(airbagloccurtain) AS airbag_loc_curtain,
    TRY_CAST(airbaglocseatcushionid AS INTEGER) AS airbag_loc_seat_cushion_id,
    LOWER(airbaglocseatcushion) AS airbag_loc_seat_cushion,
    LOWER(otherrestraintsysteminfo) AS other_restraint_system_info,
    TRY_CAST(forwardcollisionwarningid AS INTEGER) AS forward_collision_warning_id,
    LOWER(forwardcollisionwarning) AS forward_collision_warning,
    TRY_CAST(dynamicbrakesupportid AS INTEGER) AS dynamic_brake_support_id,
    LOWER(dynamicbrakesupport) AS dynamic_brake_support,
    TRY_CAST(crashimminentbrakingid AS INTEGER) AS crash_imminent_braking_id,
    LOWER(crashimminentbraking) AS crash_imminent_braking,
    TRY_CAST(pedestrianautoemergencybrakingid AS INTEGER) AS pedestrian_auto_emergency_braking_id,
    LOWER(pedestrianautoemergencybraking) AS pedestrian_auto_emergency_braking,
    TRY_CAST(blindspotwarningid AS INTEGER) AS blind_spot_warning_id,
    LOWER(blindspotwarning) AS blind_spot_warning,
    TRY_CAST(blindspotinterventionid AS INTEGER) AS blind_spot_intervention_id,
    LOWER(blindspotintervention) AS blind_spot_intervention,
    TRY_CAST(lanedeparturewarningid AS INTEGER) AS lane_departure_warning_id,
    LOWER(lanedeparturewarning) AS lane_departure_warning,
    TRY_CAST(lanekeepingassistanceid AS INTEGER) AS lane_keeping_assistance_id,
    LOWER(lanekeepingassistance) AS lane_keeping_assistance,
    TRY_CAST(lanecenteringassistanceid AS INTEGER) AS lane_centering_assistance_id,
    LOWER(lanecenteringassistance) AS lane_centering_assistance,
    TRY_CAST(backupcameraid AS INTEGER) AS backup_camera_id,
    LOWER(backupcamera) AS backup_camera,
    TRY_CAST(rearcrosstrafficalertid AS INTEGER) AS rear_cross_traffic_alert_id,
    LOWER(rearcrosstrafficalert) AS rear_cross_traffic_alert,
    TRY_CAST(rearautomaticemergencybrakingid AS INTEGER) AS rear_automatic_emergency_braking_id,
    LOWER(rearautomaticemergencybraking) AS rear_automatic_emergency_braking,
    TRY_CAST(parkassistid AS INTEGER) AS park_assist_id,
    LOWER(parkassist) AS park_assist,
    TRY_CAST(daytimerunninglightid AS INTEGER) AS daytime_running_light_id,
    LOWER(daytimerunninglight) AS daytime_running_light,
    TRY_CAST(headlamplightsourceid AS INTEGER) AS headlamp_light_source_id,
    LOWER(headlamplightsource) AS headlamp_light_source,
    TRY_CAST(semiautoheadlampbeamswitchingid AS INTEGER) AS semi_auto_headlamp_beam_switching_id,
    LOWER(semiautoheadlampbeamswitching) AS semi_auto_headlamp_beam_switching,
    TRY_CAST(adaptivedrivingbeamid AS INTEGER) AS adaptive_driving_beam_id,
    LOWER(adaptivedrivingbeam) AS adaptive_driving_beam,
    TRY_CAST(adaptivecruisecontrolid AS INTEGER) AS adaptive_cruise_control_id,
    LOWER(adaptivecruisecontrol) AS adaptive_cruise_control,
    TRY_CAST(antilockbrakesystemid AS INTEGER) AS anti_lock_brake_system_id,
    LOWER(antilockbrakesystem) AS anti_lock_brake_system,
    TRY_CAST(electronicstabilitycontrolid AS INTEGER) AS electronic_stability_control_id,
    LOWER(electronicstabilitycontrol) AS electronic_stability_control,
    TRY_CAST(tpmsid AS INTEGER) AS tpms_id,
    LOWER(tpms) AS tpms,
    TRY_CAST(automaticcrashnotificationid AS INTEGER) AS automatic_crash_notification_id,
    LOWER(automaticcrashnotification) AS automatic_crash_notification,
    TRY_CAST(eventdatarecorderid AS INTEGER) AS event_data_recorder_id,
    LOWER(eventdatarecorder) AS event_data_recorder,
    TRY_CAST(tractioncontrolid AS INTEGER) AS traction_control_id,
    LOWER(tractioncontrol) AS traction_control,
    TRY_CAST(autoPedestrianAlertingSoundId AS INTEGER) AS auto_pedestrian_alerting_sound_id,
    LOWER(autoPedestrianAlertingSound) AS auto_pedestrian_alerting_sound,
    TRY_CAST(keylessignitionid AS INTEGER) AS keyless_ignition_id,
    LOWER(keylessignition) AS keyless_ignition,
    TRY_CAST(saeautomationlevel_from AS INTEGER) AS sae_automation_level_from,
    TRY_CAST(saeautomationlevel_to AS INTEGER) AS sae_automation_level_to,
    TRY_CAST(autoreversesystemid AS INTEGER) AS auto_reverse_system_id,
    LOWER(autoreversesystem) AS auto_reverse_system,
    LOWER(activesafetysysnote) AS active_safety_sys_note
FROM bronze_vpicdecode
WHERE st_case IS NOT NULL AND veh_no IS NOT NULL;
