CREATE SCHEMA IF NOT EXISTS silver;

CREATE OR REPLACE TABLE silver.silver_vpicdecode AS
SELECT
    TRY_CAST(STATE AS INTEGER) AS STATE,
    STATENAME AS STATENAME,
    TRY_CAST(ST_CASE AS INTEGER) AS ST_CASE,
    TRY_CAST(VEH_NO AS INTEGER) AS VEH_NO,
    VEHICLEDESCRIPTOR AS VEHICLEDESCRIPTOR,
    VINDECODEDON AS VINDECODEDON,
    TRY_CAST(VINDECODEERROR AS INTEGER) AS VINDECODEERROR,
    TRY_CAST(VEHICLETYPEID AS INTEGER) AS VEHICLETYPEID,
    VEHICLETYPE AS VEHICLETYPE,
    TRY_CAST(MANUFACTURERFULLNAMEID AS INTEGER) AS MANUFACTURERFULLNAMEID,
    MANUFACTURERFULLNAME AS MANUFACTURERFULLNAME,
    TRY_CAST(MAKEID AS INTEGER) AS MAKEID,
    MAKE AS MAKE,
    TRY_CAST(MODELID AS INTEGER) AS MODELID,
    MODEL AS MODEL,
    TRY_CAST(MODELYEAR AS INTEGER) AS MODELYEAR,
    SERIES AS SERIES,
    TRIM AS TRIM,
    SERIES2 AS SERIES2,
    TRIM2 AS TRIM2,
    TRY_CAST(PLANTCOUNTRYID AS INTEGER) AS PLANTCOUNTRYID,
    PLANTCOUNTRY AS PLANTCOUNTRY,
    PLANTSTATE AS PLANTSTATE,
    PLANTCITY AS PLANTCITY,
    PLANTCOMPANYNAME AS PLANTCOMPANYNAME,
    TRY_CAST(DESTINATIONMARKETID AS INTEGER) AS DESTINATIONMARKETID,
    DESTINATIONMARKET AS DESTINATIONMARKET,
    TRY_CAST(BASEPRICE AS DOUBLE) AS BASEPRICE,
    TRY_CAST(NONLANDUSEID AS INTEGER) AS NONLANDUSEID,
    NONLANDUSE AS NONLANDUSE,
    NOTE AS NOTE,
    TRY_CAST(BODYCLASSID AS INTEGER) AS BODYCLASSID,
    BODYCLASS AS BODYCLASS,
    TRY_CAST(DOORSCOUNT AS INTEGER) AS DOORSCOUNT,
    TRY_CAST(WINDOWS AS INTEGER) AS WINDOWS,
    TRY_CAST(WHEELBASETYPEID AS INTEGER) AS WHEELBASETYPEID,
    WHEELBASETYPE AS WHEELBASETYPE,
    TRY_CAST(TRACKWIDTHIN AS DOUBLE) AS TRACKWIDTHIN,
    TRY_CAST(GROSSVEHICLEWEIGHTRATINGFROMID AS INTEGER) AS GROSSVEHICLEWEIGHTRATINGFROMID,
    GROSSVEHICLEWEIGHTRATINGFROM AS GROSSVEHICLEWEIGHTRATINGFROM,
    TRY_CAST(GROSSVEHICLEWEIGHTRATINGTOID AS INTEGER) AS GROSSVEHICLEWEIGHTRATINGTOID,
    GROSSVEHICLEWEIGHTRATINGTO AS GROSSVEHICLEWEIGHTRATINGTO,
    TRY_CAST(GROSSCOMBWEIGHTRATINGFROMID AS INTEGER) AS GROSSCOMBWEIGHTRATINGFROMID,
    GROSSCOMBWEIGHTRATINGFROM AS GROSSCOMBWEIGHTRATINGFROM,
    TRY_CAST(GROSSCOMBWEIGHTRATINGTOID AS INTEGER) AS GROSSCOMBWEIGHTRATINGTOID,
    GROSSCOMBWEIGHTRATINGTO AS GROSSCOMBWEIGHTRATINGTO,
    TRY_CAST(CURBWEIGHTLB AS DOUBLE) AS CURBWEIGHTLB,
    TRY_CAST(WHEELBASEIN_FROM AS DOUBLE) AS WHEELBASEIN_FROM,
    TRY_CAST(WHEELBASEIN_TO AS DOUBLE) AS WHEELBASEIN_TO,
    TRY_CAST(WHEELSCOUNT AS INTEGER) AS WHEELSCOUNT,
    TRY_CAST(WHEELSIZEFRONTIN AS DOUBLE) AS WHEELSIZEFRONTIN,
    TRY_CAST(WHEELSIZEREARIN AS DOUBLE) AS WHEELSIZEREARIN,
    TRY_CAST(TRUCKBODYCABTYPEID AS INTEGER) AS TRUCKBODYCABTYPEID,
    TRUCKBODYCABTYPE AS TRUCKBODYCABTYPE,
    TRY_CAST(TRUCKBEDTYPEID AS INTEGER) AS TRUCKBEDTYPEID,
    TRUCKBEDTYPE AS TRUCKBEDTYPE,
    TRY_CAST(TRUCKBEDLENGTHIN AS DOUBLE) AS TRUCKBEDLENGTHIN,
    TRY_CAST(BUSTYPEID AS INTEGER) AS BUSTYPEID,
    BUSTYPE AS BUSTYPE,
    TRY_CAST(BUSFLOORCONFIGURATIONTYPEID AS INTEGER) AS BUSFLOORCONFIGURATIONTYPEID,
    BUSFLOORCONFIGURATIONTYPE AS BUSFLOORCONFIGURATIONTYPE,
    TRY_CAST(BUSLENGTHFT AS DOUBLE) AS BUSLENGTHFT,
    OTHERBUSINFO AS OTHERBUSINFO,
    TRY_CAST(CUSTOMMOTORCYCLETYPEID AS INTEGER) AS CUSTOMMOTORCYCLETYPEID,
    CUSTOMMOTORCYCLETYPE AS CUSTOMMOTORCYCLETYPE,
    TRY_CAST(MOTORCYCLESUSPENSIONTYPEID AS INTEGER) AS MOTORCYCLESUSPENSIONTYPEID,
    MOTORCYCLESUSPENSIONTYPE AS MOTORCYCLESUSPENSIONTYPE,
    TRY_CAST(MOTORCYCLECHASSISTYPEID AS INTEGER) AS MOTORCYCLECHASSISTYPEID,
    MOTORCYCLECHASSISTYPE AS MOTORCYCLECHASSISTYPE,
    OTHERMOTORCYCLEINFO AS OTHERMOTORCYCLEINFO,
    TRY_CAST(STEERINGLOCATIONID AS INTEGER) AS STEERINGLOCATIONID,
    STEERINGLOCATION AS STEERINGLOCATION,
    TRY_CAST(ENTERTAINMENTSYSTEMID AS INTEGER) AS ENTERTAINMENTSYSTEMID,
    ENTERTAINMENTSYSTEM AS ENTERTAINMENTSYSTEM,
    TRY_CAST(SEATSCOUNT AS INTEGER) AS SEATSCOUNT,
    TRY_CAST(SEATROWSCOUNT AS INTEGER) AS SEATROWSCOUNT,
    TRY_CAST(TRANSMISSIONSPEEDS AS INTEGER) AS TRANSMISSIONSPEEDS,
    TRY_CAST(TRANSMISSIONSTYLEID AS INTEGER) AS TRANSMISSIONSTYLEID,
    TRANSMISSIONSTYLE AS TRANSMISSIONSTYLE,
    TRY_CAST(DRIVETYPEID AS INTEGER) AS DRIVETYPEID,
    DRIVETYPE AS DRIVETYPE,
    TRY_CAST(AXLESCOUNT AS INTEGER) AS AXLESCOUNT,
    TRY_CAST(AXLECONFIGURATIONID AS INTEGER) AS AXLECONFIGURATIONID,
    AXLECONFIGURATION AS AXLECONFIGURATION,
    TRY_CAST(BRAKESYSTEMTYPEID AS INTEGER) AS BRAKESYSTEMTYPEID,
    BRAKESYSTEMTYPE AS BRAKESYSTEMTYPE,
    BRAKESYSTEMDESC AS BRAKESYSTEMDESC,
    TRY_CAST(EVDRIVEUNITID AS INTEGER) AS EVDRIVEUNITID,
    EVDRIVEUNIT AS EVDRIVEUNIT,
    TRY_CAST(BATTERYKWH_FROM AS DOUBLE) AS BATTERYKWH_FROM,
    TRY_CAST(BATTERYKWH_TO AS DOUBLE) AS BATTERYKWH_TO,
    TRY_CAST(BATTERYV_FROM AS DOUBLE) AS BATTERYV_FROM,
    TRY_CAST(BATTERYV_TO AS DOUBLE) AS BATTERYV_TO,
    TRY_CAST(BATTERYA_FROM AS DOUBLE) AS BATTERYA_FROM,
    TRY_CAST(BATTERYA_TO AS DOUBLE) AS BATTERYA_TO,
    TRY_CAST(BATTERYPACKSPERVEHICLE AS INTEGER) AS BATTERYPACKSPERVEHICLE,
    TRY_CAST(BATTERYMODULESPERPACK AS INTEGER) AS BATTERYMODULESPERPACK,
    TRY_CAST(BATTERYCELLSPERMODULE AS INTEGER) AS BATTERYCELLSPERMODULE,
    TRY_CAST(BATTERYTYPEID AS INTEGER) AS BATTERYTYPEID,
    BATTERYTYPE AS BATTERYTYPE,
    OTHERBATTERYINFO AS OTHERBATTERYINFO,
    TRY_CAST(CHARGERLEVELID AS INTEGER) AS CHARGERLEVELID,
    CHARGERLEVEL AS CHARGERLEVEL,
    TRY_CAST(CHARGERPOWERKW AS DOUBLE) AS CHARGERPOWERKW,
    ENGINEMANUFACTURER AS ENGINEMANUFACTURER,
    ENGINEMODEL AS ENGINEMODEL,
    TRY_CAST(ENGINECONFIGURATIONID AS INTEGER) AS ENGINECONFIGURATIONID,
    ENGINECONFIGURATION AS ENGINECONFIGURATION,
    TRY_CAST(ENGINEPOWERKW AS DOUBLE) AS ENGINEPOWERKW,
    TRY_CAST(ENGINESTROKECYCLES AS INTEGER) AS ENGINESTROKECYCLES,
    TRY_CAST(ENGINECYLINDERSCOUNT AS INTEGER) AS ENGINECYLINDERSCOUNT,
    TRY_CAST(ENGINEBRAKEHP_FROM AS DOUBLE) AS ENGINEBRAKEHP_FROM,
    TRY_CAST(ENGINEBRAKEHP_TO AS DOUBLE) AS ENGINEBRAKEHP_TO,
    TRY_CAST(ENGINECOOLINGTYPEID AS INTEGER) AS ENGINECOOLINGTYPEID,
    ENGINECOOLINGTYPE AS ENGINECOOLINGTYPE,
    TRY_CAST(DISPLACEMENTCI AS DOUBLE) AS DISPLACEMENTCI,
    TRY_CAST(DISPLACEMENTCC AS DOUBLE) AS DISPLACEMENTCC,
    TRY_CAST(DISPLACEMENTL AS DOUBLE) AS DISPLACEMENTL,
    TRY_CAST(FUELTYPEPRIMARYID AS INTEGER) AS FUELTYPEPRIMARYID,
    FUELTYPEPRIMARY AS FUELTYPEPRIMARY,
    TRY_CAST(FUELTYPESECONDARYID AS INTEGER) AS FUELTYPESECONDARYID,
    FUELTYPESECONDARY AS FUELTYPESECONDARY,
    TRY_CAST(FUELDELIVERYINJECTIONTYPEID AS INTEGER) AS FUELDELIVERYINJECTIONTYPEID,
    FUELDELIVERYINJECTIONTYPE AS FUELDELIVERYINJECTIONTYPE,
    TRY_CAST(ENGINEVALVETRAINDESIGNID AS INTEGER) AS ENGINEVALVETRAINDESIGNID,
    ENGINEVALVETRAINDESIGN AS ENGINEVALVETRAINDESIGN,
    TRY_CAST(ENGINEELECTRIFICATIONLEVELID AS INTEGER) AS ENGINEELECTRIFICATIONLEVELID,
    ENGINEELECTRIFICATIONLEVEL AS ENGINEELECTRIFICATIONLEVEL,
    TRY_CAST(ENGINETURBOID AS INTEGER) AS ENGINETURBOID,
    ENGINETURBO AS ENGINETURBO,
    TRY_CAST(TOPSPEEDMPH AS DOUBLE) AS TOPSPEEDMPH,
    OTHERENGINEINFO AS OTHERENGINEINFO,
    TRY_CAST(SEATBELTTYPEID AS INTEGER) AS SEATBELTTYPEID,
    SEATBELTTYPE AS SEATBELTTYPE,
    TRY_CAST(PRETENSIONERID AS INTEGER) AS PRETENSIONERID,
    PRETENSIONER AS PRETENSIONER,
    TRY_CAST(AIRBAGLOCFRONTID AS INTEGER) AS AIRBAGLOCFRONTID,
    AIRBAGLOCFRONT AS AIRBAGLOCFRONT,
    TRY_CAST(AIRBAGLOCKNEEID AS INTEGER) AS AIRBAGLOCKNEEID,
    AIRBAGLOCKNEE AS AIRBAGLOCKNEE,
    TRY_CAST(AIRBAGLOCSIDEID AS INTEGER) AS AIRBAGLOCSIDEID,
    AIRBAGLOCSIDE AS AIRBAGLOCSIDE,
    TRY_CAST(AIRBAGLOCCURTAINID AS INTEGER) AS AIRBAGLOCCURTAINID,
    AIRBAGLOCCURTAIN AS AIRBAGLOCCURTAIN,
    TRY_CAST(AIRBAGLOCSEATCUSHIONID AS INTEGER) AS AIRBAGLOCSEATCUSHIONID,
    AIRBAGLOCSEATCUSHION AS AIRBAGLOCSEATCUSHION,
    OTHERRESTRAINTSYSTEMINFO AS OTHERRESTRAINTSYSTEMINFO,
    TRY_CAST(FORWARDCOLLISIONWARNINGID AS INTEGER) AS FORWARDCOLLISIONWARNINGID,
    FORWARDCOLLISIONWARNING AS FORWARDCOLLISIONWARNING,
    TRY_CAST(DYNAMICBRAKESUPPORTID AS INTEGER) AS DYNAMICBRAKESUPPORTID,
    DYNAMICBRAKESUPPORT AS DYNAMICBRAKESUPPORT,
    TRY_CAST(CRASHIMMINENTBRAKINGID AS INTEGER) AS CRASHIMMINENTBRAKINGID,
    CRASHIMMINENTBRAKING AS CRASHIMMINENTBRAKING,
    TRY_CAST(PEDESTRIANAUTOEMERGENCYBRAKINGID AS INTEGER) AS PEDESTRIANAUTOEMERGENCYBRAKINGID,
    PEDESTRIANAUTOEMERGENCYBRAKING AS PEDESTRIANAUTOEMERGENCYBRAKING,
    TRY_CAST(BLINDSPOTWARNINGID AS INTEGER) AS BLINDSPOTWARNINGID,
    BLINDSPOTWARNING AS BLINDSPOTWARNING,
    TRY_CAST(BLINDSPOTINTERVENTIONID AS INTEGER) AS BLINDSPOTINTERVENTIONID,
    BLINDSPOTINTERVENTION AS BLINDSPOTINTERVENTION,
    TRY_CAST(LANEDEPARTUREWARNINGID AS INTEGER) AS LANEDEPARTUREWARNINGID,
    LANEDEPARTUREWARNING AS LANEDEPARTUREWARNING,
    TRY_CAST(LANEKEEPINGASSISTANCEID AS INTEGER) AS LANEKEEPINGASSISTANCEID,
    LANEKEEPINGASSISTANCE AS LANEKEEPINGASSISTANCE,
    TRY_CAST(LANECENTERINGASSISTANCEID AS INTEGER) AS LANECENTERINGASSISTANCEID,
    LANECENTERINGASSISTANCE AS LANECENTERINGASSISTANCE,
    TRY_CAST(BACKUPCAMERAID AS INTEGER) AS BACKUPCAMERAID,
    BACKUPCAMERA AS BACKUPCAMERA,
    TRY_CAST(REARCROSSTRAFFICALERTID AS INTEGER) AS REARCROSSTRAFFICALERTID,
    REARCROSSTRAFFICALERT AS REARCROSSTRAFFICALERT,
    TRY_CAST(REARAUTOMATICEMERGENCYBRAKINGID AS INTEGER) AS REARAUTOMATICEMERGENCYBRAKINGID,
    REARAUTOMATICEMERGENCYBRAKING AS REARAUTOMATICEMERGENCYBRAKING,
    TRY_CAST(PARKASSISTID AS INTEGER) AS PARKASSISTID,
    PARKASSIST AS PARKASSIST,
    TRY_CAST(DAYTIMERUNNINGLIGHTID AS INTEGER) AS DAYTIMERUNNINGLIGHTID,
    DAYTIMERUNNINGLIGHT AS DAYTIMERUNNINGLIGHT,
    TRY_CAST(HEADLAMPLIGHTSOURCEID AS INTEGER) AS HEADLAMPLIGHTSOURCEID,
    HEADLAMPLIGHTSOURCE AS HEADLAMPLIGHTSOURCE,
    TRY_CAST(SEMIAUTOHEADLAMPBEAMSWITCHINGID AS INTEGER) AS SEMIAUTOHEADLAMPBEAMSWITCHINGID,
    SEMIAUTOHEADLAMPBEAMSWITCHING AS SEMIAUTOHEADLAMPBEAMSWITCHING,
    TRY_CAST(ADAPTIVEDRIVINGBEAMID AS INTEGER) AS ADAPTIVEDRIVINGBEAMID,
    ADAPTIVEDRIVINGBEAM AS ADAPTIVEDRIVINGBEAM,
    TRY_CAST(ADAPTIVECRUISECONTROLID AS INTEGER) AS ADAPTIVECRUISECONTROLID,
    ADAPTIVECRUISECONTROL AS ADAPTIVECRUISECONTROL,
    TRY_CAST(ANTILOCKBRAKESYSTEMID AS INTEGER) AS ANTILOCKBRAKESYSTEMID,
    ANTILOCKBRAKESYSTEM AS ANTILOCKBRAKESYSTEM,
    TRY_CAST(ELECTRONICSTABILITYCONTROLID AS INTEGER) AS ELECTRONICSTABILITYCONTROLID,
    ELECTRONICSTABILITYCONTROL AS ELECTRONICSTABILITYCONTROL,
    TRY_CAST(TPMSID AS INTEGER) AS TPMSID,
    TPMS AS TPMS,
    TRY_CAST(AUTOMATICCRASHNOTIFICATIONID AS INTEGER) AS AUTOMATICCRASHNOTIFICATIONID,
    AUTOMATICCRASHNOTIFICATION AS AUTOMATICCRASHNOTIFICATION,
    TRY_CAST(EVENTDATARECORDERID AS INTEGER) AS EVENTDATARECORDERID,
    EVENTDATARECORDER AS EVENTDATARECORDER,
    TRY_CAST(TRACTIONCONTROLID AS INTEGER) AS TRACTIONCONTROLID,
    TRACTIONCONTROL AS TRACTIONCONTROL,
    TRY_CAST(AUTOPEDESTRIANALERTINGSOUNDID AS INTEGER) AS AUTOPEDESTRIANALERTINGSOUNDID,
    AUTOPEDESTRIANALERTINGSOUND AS AUTOPEDESTRIANALERTINGSOUND,
    TRY_CAST(KEYLESSIGNITIONID AS INTEGER) AS KEYLESSIGNITIONID,
    KEYLESSIGNITION AS KEYLESSIGNITION,
    TRY_CAST(SAEAUTOMATIONLEVEL_FROM AS INTEGER) AS SAEAUTOMATIONLEVEL_FROM,
    TRY_CAST(SAEAUTOMATIONLEVEL_TO AS INTEGER) AS SAEAUTOMATIONLEVEL_TO,
    TRY_CAST(AUTOREVERSESYSTEMID AS INTEGER) AS AUTOREVERSESYSTEMID,
    AUTOREVERSESYSTEM AS AUTOREVERSESYSTEM,
    ACTIVESAFETYSYSNOTE AS ACTIVESAFETYSYSNOTE
FROM bronze.bronze_vpicdecode
WHERE ST_CASE IS NOT NULL AND VEH_NO IS NOT NULL;
